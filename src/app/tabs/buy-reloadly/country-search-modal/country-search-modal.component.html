<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="dismiss()">
        <ion-icon name="close"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>Select Country</ion-title>
  </ion-toolbar>
  <ion-toolbar>
    <ion-searchbar
      [(ngModel)]="searchTerm"
      (ionInput)="filterCountries()"
      placeholder="Search countries..."
      animated
      showCancelButton="focus"
      cancelButtonText="Cancel"
      debounce="300"
      class="searchbar"
    ></ion-searchbar>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <ion-list>
    <ion-item
      *ngFor="let country of filteredCountries"
      button
      detail="false"
      (click)="selectCountry(country)"
      class="country-item"
    >
      <ion-avatar slot="start" class="flag-avatar">
        <img 
          [src]="'https://flagcdn.com/w40/' + country.isoName.toLowerCase() + '.png'" 
          [alt]="country.name + ' flag'"
          class="country-flag"
          onerror="this.style.display='none'"
        />
      </ion-avatar>
      <ion-label>
        <h2>{{ country.name }}</h2>
        <p *ngIf="country.isoName">{{ country.isoName }}</p>
      </ion-label>
    </ion-item>
  </ion-list>

  <div class="no-results" *ngIf="filteredCountries.length === 0">
    <ion-icon name="search-outline"></ion-icon>
    <p>No countries found</p>
  </div>
</ion-content>
